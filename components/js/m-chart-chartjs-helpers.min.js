var m_chart_chartjs_helpers = {
    number_format_locale: "en-US",
    number_format_options: { maximumFractionDigits: 2 }
};
!(function(e) {
    "use strict";
    (m_chart_chartjs_helpers.init = function() {
        e(".m-chart").on("render_start", function(a) {
            var r,
                t,
                s,
                a = "m_chart_chartjs_" + a.post_id + "_" + a.instance;
            void 0 !== window[a] &&
                ((r = window[a].chart_args.type),
                (t = window[a].chart_args.value_prefix),
                (s = window[a].chart_args.value_suffix),
                (m_chart_chartjs_helpers.number_format_locale =
                    window[a].chart_args.locale),
                "bubble" == window[a].chart_args.type
                    ? ((window[
                          a
                      ].chart_args.data = m_chart_chartjs_helpers.preprocess_bubble_data(
                          window[a].chart_args.data
                      )),
                      (window[
                          a
                      ].chart_args.options.plugins.tooltip.callbacks = {
                          label: a =>
                              m_chart_chartjs_helpers.bubble_chart_tooltip_label(
                                  a,
                                  r,
                                  t,
                                  s
                              )
                      }))
                    : "scatter" == window[a].chart_args.type
                    ? (window[
                          a
                      ].chart_args.options.plugins.tooltip.callbacks = {
                          label: a =>
                              m_chart_chartjs_helpers.scatter_chart_tooltip_label(
                                  a,
                                  r,
                                  t,
                                  s
                              )
                      })
                    : (window[
                          a
                      ].chart_args.options.plugins.tooltip.callbacks = {
                          label: a =>
                              m_chart_chartjs_helpers.chart_tooltip_label(
                                  a,
                                  r,
                                  t,
                                  s
                              )
                      }),
                (window[
                    a
                ].chart_args.options.plugins.datalabels.formatter = function(
                    a
                ) {
                    return null === a
                        ? a
                        : (void 0 !== a.label
                              ? (a = a.label)
                              : void 0 !== a.r
                              ? (a = a.r)
                              : void 0 !== a.y && (a = a.y),
                          e.isNumeric(a)
                              ? m_chart_chartjs_helpers.number_format(a)
                              : a);
                }),
                "pie" != window[a].chart_args.type &&
                    "doughnut" != window[a].chart_args.type &&
                    "polarArea" != window[a].chart_args.type &&
                    "radar" != window[a].chart_args.type &&
                    m_chart_chartjs_helpers.start_tick_formatting(a));
        });
    }),
        (m_chart_chartjs_helpers.preprocess_bubble_data = function(a) {
            var r = a.datasets[0].data.reduce((a, r) => Math.max(a, r.r), 0);
            for (const s of a.datasets)
                for (const e of s.data) {
                    e.original = e.r;
                    var t = Math.sqrt(Math.abs(e.r) / r);
                    e.r = 30 * t + 1;
                }
            return a;
        }),
        (m_chart_chartjs_helpers.bubble_chart_tooltip_label = function(
            a,
            r,
            t,
            s
        ) {
            return [
                a.raw.label,
                a.chart.data.labels[0] +
                    ": " +
                    m_chart_chartjs_helpers.number_format(a.parsed.x),
                a.chart.data.labels[1] +
                    ": " +
                    m_chart_chartjs_helpers.number_format(a.parsed.y),
                a.chart.data.labels[2] +
                    ": " +
                    m_chart_chartjs_helpers.number_format(a.raw.original)
            ];
        }),
        (m_chart_chartjs_helpers.scatter_chart_tooltip_label = function(
            a,
            r,
            t,
            s
        ) {
            return [
                a.dataset.label,
                a.chart.data.labels[0] +
                    ": " +
                    m_chart_chartjs_helpers.number_format(a.parsed.x),
                a.chart.data.labels[1] +
                    ": " +
                    m_chart_chartjs_helpers.number_format(a.parsed.y)
            ];
        }),
        (m_chart_chartjs_helpers.chart_tooltip_label = function(a, r, t, s) {
            var e = a.dataset.label;
            return null == a.raw
                ? null
                : (void 0 === e && (e = a.label),
                  "bar" == r && (e = ""),
                  "" !=
                      (e =
                          "polarArea" == r
                              ? a.chart.data.labels[a.dataIndex]
                              : e) && (e += ": "),
                  e + t + m_chart_chartjs_helpers.number_format(a.raw) + s);
        }),
        (m_chart_chartjs_helpers.start_tick_formatting = function(a) {
            var r = {
                callback: function(a, r, t) {
                    return (
                        this.getLabelForValue(a) &&
                            (a = this.getLabelForValue(a)),
                        m_chart_chartjs_helpers.is_numeric(a)
                            ? m_chart_chartjs_helpers.number_format(a)
                            : a
                    );
                }
            };
            void 0 === window[a].chart_args.options.scales.x.ticks &&
                (window[a].chart_args.options.scales.x.ticks = {}),
                void 0 === window[a].chart_args.options.scales.y.ticks &&
                    (window[a].chart_args.options.scales.y.ticks = {}),
                (window[a].chart_args.options.scales.x.ticks = Object.assign(
                    window[a].chart_args.options.scales.x.ticks,
                    r
                )),
                (window[a].chart_args.options.scales.y.ticks = Object.assign(
                    window[a].chart_args.options.scales.y.ticks,
                    r
                ));
        }),
        (m_chart_chartjs_helpers.number_format = function(a) {
            return new Intl.NumberFormat(
                this.number_format_locale,
                this.number_format_options
            ).format(a);
        }),
        (m_chart_chartjs_helpers.is_numeric = function(a) {
            return !/^\d{4}$/.test(a) && /^[0-9.]*$/.test(a);
        }),
        e(function() {
            m_chart_chartjs_helpers.init();
        });
})(jQuery);
